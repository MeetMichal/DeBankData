using CsvHelper;
using DeBankUI.Components;
using DeBankUI.Utils;
using LiveChartsCore;
using LiveChartsCore.Defaults;
using LiveChartsCore.SkiaSharpView;
using LiveChartsCore.SkiaSharpView.Painting;
using MudBlazor.Extensions;
using SkiaSharp;
using System.Globalization;

namespace DeBankUI.Shared.Michal
{
    public partial class StreamActivityTotalChart : BaseChartComponent
    {
        private static readonly SKColor black = SKColors.Black;

        public StreamActivityTotalChart()
        {
            XAxes = new[]
            {
                new DateTimeAxis(TimeSpan.FromDays(1), date => date.ToString("yyyy-MM-dd"))
                {
                    LabelsRotation = 30,
                    TicksPaint = new SolidColorPaint(black),
                    NamePaint = new SolidColorPaint(black),
                    LabelsPaint = new SolidColorPaint(black),
                }
            };

            YAxes = new[]
            {
                new Axis
                {
                    Name = "Total number of posts",
                    NamePaint = new SolidColorPaint(Colors.SerieBlue),
                    LabelsPaint = new SolidColorPaint(Colors.SerieBlue),
                    TicksPaint = new SolidColorPaint(Colors.SerieBlue),
                    SubticksPaint = new SolidColorPaint(Colors.SerieBlue),
                },
                new Axis
                {
                    Name = "Total number of post authors",
                    ShowSeparatorLines = false,
                    Position = LiveChartsCore.Measure.AxisPosition.End,
                    NamePaint = new SolidColorPaint(Colors.SerieRed),
                    LabelsPaint = new SolidColorPaint(Colors.SerieRed),
                    TicksPaint = new SolidColorPaint(Colors.SerieRed),
                    SubticksPaint = new SolidColorPaint(Colors.SerieRed),
                },
            };

            Series = new[]
            {
                new LineSeries<DateTimePoint>
                {
                    Name="Total number of posts",
                    DataPadding = new LiveChartsCore.Drawing.LvcPoint(0,0),
                    Stroke = new SolidColorPaint(Colors.SerieBlue,4),
                    GeometryStroke = null,
                    GeometrySize = 0,
                    Fill = null,
                    LineSmoothness = 1,
                    ScalesYAt = 0, // it will be scaled at the Axis[0] instance
                    ScalesXAt = 0,
                    Values = new List<DateTimePoint>
                    {
                        new DateTimePoint(new DateTime(2023,5,6),638),
                        new DateTimePoint(new DateTime(2023,5,7),1763),
                        new DateTimePoint(new DateTime(2023,5,8),3341),
                        new DateTimePoint(new DateTime(2023,5,9),4540),
                        new DateTimePoint(new DateTime(2023,5,10),5527),
                        new DateTimePoint(new DateTime(2023,5,11),6326),
                        new DateTimePoint(new DateTime(2023,5,12),6945),
                        new DateTimePoint(new DateTime(2023,5,13),7496),
                        new DateTimePoint(new DateTime(2023,5,14),7985),
                        new DateTimePoint(new DateTime(2023,5,15),8856),
                        new DateTimePoint(new DateTime(2023,5,16),9347),
                        new DateTimePoint(new DateTime(2023,5,17),10023),
                        new DateTimePoint(new DateTime(2023,5,18),10401),
                        new DateTimePoint(new DateTime(2023,5,19),10766),
                        new DateTimePoint(new DateTime(2023,5,20),11178),
                        new DateTimePoint(new DateTime(2023,5,21),11587),
                        new DateTimePoint(new DateTime(2023,5,22),12083),
                        new DateTimePoint(new DateTime(2023,5,23),12630),
                        new DateTimePoint(new DateTime(2023,5,24),13250),
                        new DateTimePoint(new DateTime(2023,5,25),14884),
                        new DateTimePoint(new DateTime(2023,5,26),17181),
                        new DateTimePoint(new DateTime(2023,5,27),18952),
                        new DateTimePoint(new DateTime(2023,5,28),21278),
                        new DateTimePoint(new DateTime(2023,5,29),23950),
                        new DateTimePoint(new DateTime(2023,5,30),25703),
                        new DateTimePoint(new DateTime(2023,5,31),27228),
                        new DateTimePoint(new DateTime(2023,6,1),28508),
                        new DateTimePoint(new DateTime(2023,6,2),30413),
                        new DateTimePoint(new DateTime(2023,6,3),32007),
                        new DateTimePoint(new DateTime(2023,6,4),33520),
                        new DateTimePoint(new DateTime(2023,6,5),35856),
                        new DateTimePoint(new DateTime(2023,6,6),37791),
                        new DateTimePoint(new DateTime(2023,6,7),39439),
                        new DateTimePoint(new DateTime(2023,6,8),40918),
                        new DateTimePoint(new DateTime(2023,6,9),42443),
                        new DateTimePoint(new DateTime(2023,6,10),43957),
                        new DateTimePoint(new DateTime(2023,6,11),45597),
                        new DateTimePoint(new DateTime(2023,6,12),47266),
                        new DateTimePoint(new DateTime(2023,6,13),48807),
                        new DateTimePoint(new DateTime(2023,6,14),50274),
                        new DateTimePoint(new DateTime(2023,6,15),51475),
                        new DateTimePoint(new DateTime(2023,6,16),57516),
                        new DateTimePoint(new DateTime(2023,6,17),72474),
                        new DateTimePoint(new DateTime(2023,6,18),85820),
                        new DateTimePoint(new DateTime(2023,6,19),101707),
                        new DateTimePoint(new DateTime(2023,6,20),105394),
                        new DateTimePoint(new DateTime(2023,6,21),110365),
                        new DateTimePoint(new DateTime(2023,6,22),112705),
                        new DateTimePoint(new DateTime(2023,6,23),114249),
                        new DateTimePoint(new DateTime(2023,6,24),116283),
                        new DateTimePoint(new DateTime(2023,6,25),121170),
                        new DateTimePoint(new DateTime(2023,6,26),123795),
                        new DateTimePoint(new DateTime(2023,6,27),126223),
                        new DateTimePoint(new DateTime(2023,6,28),128325),
                        new DateTimePoint(new DateTime(2023,6,29),130130),
                        new DateTimePoint(new DateTime(2023,6,30),131936),
                        new DateTimePoint(new DateTime(2023,7,1),134043),
                        new DateTimePoint(new DateTime(2023,7,2),136136),
                        new DateTimePoint(new DateTime(2023,7,3),138137),
                        new DateTimePoint(new DateTime(2023,7,4),140066),
                        new DateTimePoint(new DateTime(2023,7,5),142108),
                        new DateTimePoint(new DateTime(2023,7,6),144664),
                        new DateTimePoint(new DateTime(2023,7,7),146693),
                        new DateTimePoint(new DateTime(2023,7,8),148446),
                        new DateTimePoint(new DateTime(2023,7,9),150597),
                        new DateTimePoint(new DateTime(2023,7,10),153647),
                        new DateTimePoint(new DateTime(2023,7,11),157093),
                        new DateTimePoint(new DateTime(2023,7,12),160186),
                        new DateTimePoint(new DateTime(2023,7,13),163917),
                        new DateTimePoint(new DateTime(2023,7,14),168512),
                        new DateTimePoint(new DateTime(2023,7,15),172295),
                        new DateTimePoint(new DateTime(2023,7,16),175710),
                        new DateTimePoint(new DateTime(2023,7,17),179513),
                        new DateTimePoint(new DateTime(2023,7,18),184116),
                        new DateTimePoint(new DateTime(2023,7,19),189763),
                        new DateTimePoint(new DateTime(2023,7,20),196544),
                        new DateTimePoint(new DateTime(2023,7,21),204157),
                        new DateTimePoint(new DateTime(2023,7,22),212795),
                        new DateTimePoint(new DateTime(2023,7,23),222193),
                        new DateTimePoint(new DateTime(2023,7,24),235236),
                        new DateTimePoint(new DateTime(2023,7,25),248850),
                        new DateTimePoint(new DateTime(2023,7,26),263258),
                        new DateTimePoint(new DateTime(2023,7,27),276464),
                        new DateTimePoint(new DateTime(2023,7,28),288535),
                        new DateTimePoint(new DateTime(2023,7,29),297992),
                        new DateTimePoint(new DateTime(2023,7,30),305972),
                        new DateTimePoint(new DateTime(2023,7,31),315237),
                        new DateTimePoint(new DateTime(2023,8,1),325214),
                        new DateTimePoint(new DateTime(2023,8,2),334877),
                        new DateTimePoint(new DateTime(2023,8,3),344326),
                        new DateTimePoint(new DateTime(2023,8,4),353915),
                        new DateTimePoint(new DateTime(2023,8,5),362452),
                        new DateTimePoint(new DateTime(2023,8,6),370656),
                        new DateTimePoint(new DateTime(2023,8,7),378475),
                        new DateTimePoint(new DateTime(2023,8,8),385840),
                        new DateTimePoint(new DateTime(2023,8,9),393011),
                        new DateTimePoint(new DateTime(2023,8,10),399597),
                        new DateTimePoint(new DateTime(2023,8,11),408029),
                        new DateTimePoint(new DateTime(2023,8,12),415252),
                        new DateTimePoint(new DateTime(2023,8,13),422190),
                        new DateTimePoint(new DateTime(2023,8,14),430323),
                        new DateTimePoint(new DateTime(2023,8,15),437911),
                        new DateTimePoint(new DateTime(2023,8,16),445220),
                        new DateTimePoint(new DateTime(2023,8,17),452240),
                        new DateTimePoint(new DateTime(2023,8,18),459013),
                        new DateTimePoint(new DateTime(2023,8,19),466396),
                        new DateTimePoint(new DateTime(2023,8,20),473270),
                        new DateTimePoint(new DateTime(2023,8,21),480397),
                        new DateTimePoint(new DateTime(2023,8,22),487281),
                        new DateTimePoint(new DateTime(2023,8,23),493986),
                        new DateTimePoint(new DateTime(2023,8,24),500668),
                        new DateTimePoint(new DateTime(2023,8,25),506307),
                        new DateTimePoint(new DateTime(2023,8,26),511414),
                        new DateTimePoint(new DateTime(2023,8,27),516791),
                        new DateTimePoint(new DateTime(2023,8,28),522633),
                        new DateTimePoint(new DateTime(2023,8,29),528773),
                        new DateTimePoint(new DateTime(2023,8,30),534577),
                        new DateTimePoint(new DateTime(2023,8,31),540014),
                        new DateTimePoint(new DateTime(2023,9,1),544844),
                        new DateTimePoint(new DateTime(2023,9,2),549386),
                        new DateTimePoint(new DateTime(2023,9,3),553736),
                        new DateTimePoint(new DateTime(2023,9,4),558571),
                        new DateTimePoint(new DateTime(2023,9,5),563597),
                        new DateTimePoint(new DateTime(2023,9,6),568419),
                        new DateTimePoint(new DateTime(2023,9,7),573457),
                        new DateTimePoint(new DateTime(2023,9,8),577852),
                        new DateTimePoint(new DateTime(2023,9,9),581606),
                        new DateTimePoint(new DateTime(2023,9,10),585527),
                        new DateTimePoint(new DateTime(2023,9,11),589877),
                        new DateTimePoint(new DateTime(2023,9,12),594110),
                        new DateTimePoint(new DateTime(2023,9,13),598204),
                        new DateTimePoint(new DateTime(2023,9,14),602519),
                        new DateTimePoint(new DateTime(2023,9,15),608068),
                        new DateTimePoint(new DateTime(2023,9,16),612936),
                        new DateTimePoint(new DateTime(2023,9,17),617421),
                        new DateTimePoint(new DateTime(2023,9,18),622982),
                        new DateTimePoint(new DateTime(2023,9,19),628703),
                        new DateTimePoint(new DateTime(2023,9,20),634373),
                        new DateTimePoint(new DateTime(2023,9,21),639188),
                        new DateTimePoint(new DateTime(2023,9,22),644091),
                        new DateTimePoint(new DateTime(2023,9,23),648549),
                        new DateTimePoint(new DateTime(2023,9,24),652723),
                        new DateTimePoint(new DateTime(2023,9,25),657303),
                        new DateTimePoint(new DateTime(2023,9,26),662125),
                        new DateTimePoint(new DateTime(2023,9,27),667228),
                        new DateTimePoint(new DateTime(2023,9,28),671924),
                        new DateTimePoint(new DateTime(2023,9,29),676848),
                        new DateTimePoint(new DateTime(2023,9,30),681323),
                        new DateTimePoint(new DateTime(2023,10,1),685859),
                        new DateTimePoint(new DateTime(2023,10,2),691140),
                        new DateTimePoint(new DateTime(2023,10,3),696085),
                        new DateTimePoint(new DateTime(2023,10,4),701071),
                        new DateTimePoint(new DateTime(2023,10,5),705748),
                        new DateTimePoint(new DateTime(2023,10,6),710785),
                        new DateTimePoint(new DateTime(2023,10,7),715011),
                        new DateTimePoint(new DateTime(2023,10,8),718910),
                        new DateTimePoint(new DateTime(2023,10,9),723553),
                        new DateTimePoint(new DateTime(2023,10,10),728616),
                        new DateTimePoint(new DateTime(2023,10,11),734259),
                        new DateTimePoint(new DateTime(2023,10,12),739637),
                        new DateTimePoint(new DateTime(2023,10,13),746087),
                        new DateTimePoint(new DateTime(2023,10,14),752310),
                        new DateTimePoint(new DateTime(2023,10,15),758207),
                        new DateTimePoint(new DateTime(2023,10,16),765774),
                        new DateTimePoint(new DateTime(2023,10,17),772873),
                        new DateTimePoint(new DateTime(2023,10,18),780601),
                        new DateTimePoint(new DateTime(2023,10,19),787747),
                        new DateTimePoint(new DateTime(2023,10,20),795338),
                        new DateTimePoint(new DateTime(2023,10,21),802464),
                        new DateTimePoint(new DateTime(2023,10,22),809772),
                        new DateTimePoint(new DateTime(2023,10,23),818121),
                        new DateTimePoint(new DateTime(2023,10,24),826055),
                        new DateTimePoint(new DateTime(2023,10,25),833286),
                        new DateTimePoint(new DateTime(2023,10,26),839876),
                        new DateTimePoint(new DateTime(2023,10,27),846324),
                        new DateTimePoint(new DateTime(2023,10,28),852765),
                        new DateTimePoint(new DateTime(2023,10,29),858731),
                        new DateTimePoint(new DateTime(2023,10,30),865884),
                        new DateTimePoint(new DateTime(2023,10,31),873096),
                        new DateTimePoint(new DateTime(2023,11,1),880214),
                        new DateTimePoint(new DateTime(2023,11,2),886989),
                        new DateTimePoint(new DateTime(2023,11,3),894542),
                        new DateTimePoint(new DateTime(2023,11,4),902319),
                        new DateTimePoint(new DateTime(2023,11,5),910287),
                        new DateTimePoint(new DateTime(2023,11,6),919122),
                        new DateTimePoint(new DateTime(2023,11,7),927691),
                        new DateTimePoint(new DateTime(2023,11,8),936678),
                        new DateTimePoint(new DateTime(2023,11,9),945841),
                        new DateTimePoint(new DateTime(2023,11,10),954755),
                        new DateTimePoint(new DateTime(2023,11,11),962277),
                    }
                },
                new LineSeries<DateTimePoint>
                {
                    Name = "Total number of post authors",
                    DataPadding = new LiveChartsCore.Drawing.LvcPoint(0,0),
                    Fill = null,
                    Stroke = new SolidColorPaint(Colors.SerieRed,4),
                    GeometryStroke = null,
                    GeometrySize = 0,
                    LineSmoothness = 1,
                    ScalesXAt = 0,
                    ScalesYAt = 1, // it will be scaled at the Axis[0] instance 
                    Values = new List<DateTimePoint>
                    {
                        new DateTimePoint(new DateTime(2023,5,6),498),
                        new DateTimePoint(new DateTime(2023,5,7),1297),
                        new DateTimePoint(new DateTime(2023,5,8),2350),
                        new DateTimePoint(new DateTime(2023,5,9),3093),
                        new DateTimePoint(new DateTime(2023,5,10),3649),
                        new DateTimePoint(new DateTime(2023,5,11),4100),
                        new DateTimePoint(new DateTime(2023,5,12),4425),
                        new DateTimePoint(new DateTime(2023,5,13),4709),
                        new DateTimePoint(new DateTime(2023,5,14),4923),
                        new DateTimePoint(new DateTime(2023,5,15),5274),
                        new DateTimePoint(new DateTime(2023,5,16),5484),
                        new DateTimePoint(new DateTime(2023,5,17),5753),
                        new DateTimePoint(new DateTime(2023,5,18),5896),
                        new DateTimePoint(new DateTime(2023,5,19),6032),
                        new DateTimePoint(new DateTime(2023,5,20),6145),
                        new DateTimePoint(new DateTime(2023,5,21),6277),
                        new DateTimePoint(new DateTime(2023,5,22),6454),
                        new DateTimePoint(new DateTime(2023,5,23),6673),
                        new DateTimePoint(new DateTime(2023,5,24),6871),
                        new DateTimePoint(new DateTime(2023,5,25),7718),
                        new DateTimePoint(new DateTime(2023,5,26),8632),
                        new DateTimePoint(new DateTime(2023,5,27),9313),
                        new DateTimePoint(new DateTime(2023,5,28),10225),
                        new DateTimePoint(new DateTime(2023,5,29),11377),
                        new DateTimePoint(new DateTime(2023,5,30),11959),
                        new DateTimePoint(new DateTime(2023,5,31),12394),
                        new DateTimePoint(new DateTime(2023,6,1),12661),
                        new DateTimePoint(new DateTime(2023,6,2),13265),
                        new DateTimePoint(new DateTime(2023,6,3),13694),
                        new DateTimePoint(new DateTime(2023,6,4),14062),
                        new DateTimePoint(new DateTime(2023,6,5),14724),
                        new DateTimePoint(new DateTime(2023,6,6),15148),
                        new DateTimePoint(new DateTime(2023,6,7),15455),
                        new DateTimePoint(new DateTime(2023,6,8),15712),
                        new DateTimePoint(new DateTime(2023,6,9),15990),
                        new DateTimePoint(new DateTime(2023,6,10),16237),
                        new DateTimePoint(new DateTime(2023,6,11),16545),
                        new DateTimePoint(new DateTime(2023,6,12),16770),
                        new DateTimePoint(new DateTime(2023,6,13),16969),
                        new DateTimePoint(new DateTime(2023,6,14),17112),
                        new DateTimePoint(new DateTime(2023,6,15),17225),
                        new DateTimePoint(new DateTime(2023,6,16),21590),
                        new DateTimePoint(new DateTime(2023,6,17),34815),
                        new DateTimePoint(new DateTime(2023,6,18),46588),
                        new DateTimePoint(new DateTime(2023,6,19),60875),
                        new DateTimePoint(new DateTime(2023,6,20),62845),
                        new DateTimePoint(new DateTime(2023,6,21),66053),
                        new DateTimePoint(new DateTime(2023,6,22),66904),
                        new DateTimePoint(new DateTime(2023,6,23),67080),
                        new DateTimePoint(new DateTime(2023,6,24),67972),
                        new DateTimePoint(new DateTime(2023,6,25),71642),
                        new DateTimePoint(new DateTime(2023,6,26),72492),
                        new DateTimePoint(new DateTime(2023,6,27),73114),
                        new DateTimePoint(new DateTime(2023,6,28),73674),
                        new DateTimePoint(new DateTime(2023,6,29),74011),
                        new DateTimePoint(new DateTime(2023,6,30),74264),
                        new DateTimePoint(new DateTime(2023,7,1),74604),
                        new DateTimePoint(new DateTime(2023,7,2),74945),
                        new DateTimePoint(new DateTime(2023,7,3),75188),
                        new DateTimePoint(new DateTime(2023,7,4),75446),
                        new DateTimePoint(new DateTime(2023,7,5),75801),
                        new DateTimePoint(new DateTime(2023,7,6),76157),
                        new DateTimePoint(new DateTime(2023,7,7),76481),
                        new DateTimePoint(new DateTime(2023,7,8),76827),
                        new DateTimePoint(new DateTime(2023,7,9),77320),
                        new DateTimePoint(new DateTime(2023,7,10),77979),
                        new DateTimePoint(new DateTime(2023,7,11),78829),
                        new DateTimePoint(new DateTime(2023,7,12),79602),
                        new DateTimePoint(new DateTime(2023,7,13),80552),
                        new DateTimePoint(new DateTime(2023,7,14),81428),
                        new DateTimePoint(new DateTime(2023,7,15),82064),
                        new DateTimePoint(new DateTime(2023,7,16),82534),
                        new DateTimePoint(new DateTime(2023,7,17),82986),
                        new DateTimePoint(new DateTime(2023,7,18),83675),
                        new DateTimePoint(new DateTime(2023,7,19),84841),
                        new DateTimePoint(new DateTime(2023,7,20),86331),
                        new DateTimePoint(new DateTime(2023,7,21),87818),
                        new DateTimePoint(new DateTime(2023,7,22),90215),
                        new DateTimePoint(new DateTime(2023,7,23),92592),
                        new DateTimePoint(new DateTime(2023,7,24),95858),
                        new DateTimePoint(new DateTime(2023,7,25),99365),
                        new DateTimePoint(new DateTime(2023,7,26),103628),
                        new DateTimePoint(new DateTime(2023,7,27),106250),
                        new DateTimePoint(new DateTime(2023,7,28),108597),
                        new DateTimePoint(new DateTime(2023,7,29),110137),
                        new DateTimePoint(new DateTime(2023,7,30),111380),
                        new DateTimePoint(new DateTime(2023,7,31),112552),
                        new DateTimePoint(new DateTime(2023,8,1),114146),
                        new DateTimePoint(new DateTime(2023,8,2),115307),
                        new DateTimePoint(new DateTime(2023,8,3),116486),
                        new DateTimePoint(new DateTime(2023,8,4),117779),
                        new DateTimePoint(new DateTime(2023,8,5),119094),
                        new DateTimePoint(new DateTime(2023,8,6),120298),
                        new DateTimePoint(new DateTime(2023,8,7),121270),
                        new DateTimePoint(new DateTime(2023,8,8),122025),
                        new DateTimePoint(new DateTime(2023,8,9),122875),
                        new DateTimePoint(new DateTime(2023,8,10),123555),
                        new DateTimePoint(new DateTime(2023,8,11),124776),
                        new DateTimePoint(new DateTime(2023,8,12),126064),
                        new DateTimePoint(new DateTime(2023,8,13),127185),
                        new DateTimePoint(new DateTime(2023,8,14),128145),
                        new DateTimePoint(new DateTime(2023,8,15),128938),
                        new DateTimePoint(new DateTime(2023,8,16),129615),
                        new DateTimePoint(new DateTime(2023,8,17),130219),
                        new DateTimePoint(new DateTime(2023,8,18),130799),
                        new DateTimePoint(new DateTime(2023,8,19),131530),
                        new DateTimePoint(new DateTime(2023,8,20),132337),
                        new DateTimePoint(new DateTime(2023,8,21),133008),
                        new DateTimePoint(new DateTime(2023,8,22),133489),
                        new DateTimePoint(new DateTime(2023,8,23),133944),
                        new DateTimePoint(new DateTime(2023,8,24),134327),
                        new DateTimePoint(new DateTime(2023,8,25),134657),
                        new DateTimePoint(new DateTime(2023,8,26),134969),
                        new DateTimePoint(new DateTime(2023,8,27),135293),
                        new DateTimePoint(new DateTime(2023,8,28),135626),
                        new DateTimePoint(new DateTime(2023,8,29),135872),
                        new DateTimePoint(new DateTime(2023,8,30),136129),
                        new DateTimePoint(new DateTime(2023,8,31),136407),
                        new DateTimePoint(new DateTime(2023,9,1),136573),
                        new DateTimePoint(new DateTime(2023,9,2),136762),
                        new DateTimePoint(new DateTime(2023,9,3),136965),
                        new DateTimePoint(new DateTime(2023,9,4),137216),
                        new DateTimePoint(new DateTime(2023,9,5),137399),
                        new DateTimePoint(new DateTime(2023,9,6),137607),
                        new DateTimePoint(new DateTime(2023,9,7),137815),
                        new DateTimePoint(new DateTime(2023,9,8),137964),
                        new DateTimePoint(new DateTime(2023,9,9),138111),
                        new DateTimePoint(new DateTime(2023,9,10),138287),
                        new DateTimePoint(new DateTime(2023,9,11),138455),
                        new DateTimePoint(new DateTime(2023,9,12),138591),
                        new DateTimePoint(new DateTime(2023,9,13),138754),
                        new DateTimePoint(new DateTime(2023,9,14),138956),
                        new DateTimePoint(new DateTime(2023,9,15),139103),
                        new DateTimePoint(new DateTime(2023,9,16),139332),
                        new DateTimePoint(new DateTime(2023,9,17),139486),
                        new DateTimePoint(new DateTime(2023,9,18),139691),
                        new DateTimePoint(new DateTime(2023,9,19),139894),
                        new DateTimePoint(new DateTime(2023,9,20),140081),
                        new DateTimePoint(new DateTime(2023,9,21),140260),
                        new DateTimePoint(new DateTime(2023,9,22),140409),
                        new DateTimePoint(new DateTime(2023,9,23),140566),
                        new DateTimePoint(new DateTime(2023,9,24),140701),
                        new DateTimePoint(new DateTime(2023,9,25),140844),
                        new DateTimePoint(new DateTime(2023,9,26),140994),
                        new DateTimePoint(new DateTime(2023,9,27),141119),
                        new DateTimePoint(new DateTime(2023,9,28),141241),
                        new DateTimePoint(new DateTime(2023,9,29),141372),
                        new DateTimePoint(new DateTime(2023,9,30),141530),
                        new DateTimePoint(new DateTime(2023,10,1),141691),
                        new DateTimePoint(new DateTime(2023,10,2),141861),
                        new DateTimePoint(new DateTime(2023,10,3),141990),
                        new DateTimePoint(new DateTime(2023,10,4),142094),
                        new DateTimePoint(new DateTime(2023,10,5),142210),
                        new DateTimePoint(new DateTime(2023,10,6),142324),
                        new DateTimePoint(new DateTime(2023,10,7),142429),
                        new DateTimePoint(new DateTime(2023,10,8),142599),
                        new DateTimePoint(new DateTime(2023,10,9),142700),
                        new DateTimePoint(new DateTime(2023,10,10),142829),
                        new DateTimePoint(new DateTime(2023,10,11),143017),
                        new DateTimePoint(new DateTime(2023,10,12),143195),
                        new DateTimePoint(new DateTime(2023,10,13),143366),
                        new DateTimePoint(new DateTime(2023,10,14),143544),
                        new DateTimePoint(new DateTime(2023,10,15),143765),
                        new DateTimePoint(new DateTime(2023,10,16),143957),
                        new DateTimePoint(new DateTime(2023,10,17),144168),
                        new DateTimePoint(new DateTime(2023,10,18),144367),
                        new DateTimePoint(new DateTime(2023,10,19),144524),
                        new DateTimePoint(new DateTime(2023,10,20),144684),
                        new DateTimePoint(new DateTime(2023,10,21),144903),
                        new DateTimePoint(new DateTime(2023,10,22),145447),
                        new DateTimePoint(new DateTime(2023,10,23),145696),
                        new DateTimePoint(new DateTime(2023,10,24),145908),
                        new DateTimePoint(new DateTime(2023,10,25),146078),
                        new DateTimePoint(new DateTime(2023,10,26),146230),
                        new DateTimePoint(new DateTime(2023,10,27),146365),
                        new DateTimePoint(new DateTime(2023,10,28),146535),
                        new DateTimePoint(new DateTime(2023,10,29),146680),
                        new DateTimePoint(new DateTime(2023,10,30),146795),
                        new DateTimePoint(new DateTime(2023,10,31),146918),
                        new DateTimePoint(new DateTime(2023,11,1),147132),
                        new DateTimePoint(new DateTime(2023,11,2),147321),
                        new DateTimePoint(new DateTime(2023,11,3),147458),
                        new DateTimePoint(new DateTime(2023,11,4),147798),
                        new DateTimePoint(new DateTime(2023,11,5),147968),
                        new DateTimePoint(new DateTime(2023,11,6),148176),
                        new DateTimePoint(new DateTime(2023,11,7),148357),
                        new DateTimePoint(new DateTime(2023,11,8),148502),
                        new DateTimePoint(new DateTime(2023,11,9),148645),
                        new DateTimePoint(new DateTime(2023,11,10),148919),
                        new DateTimePoint(new DateTime(2023,11,11),149057),
                    }
                }
            };
        }
        public override byte[] DownloadChartData()
        {
            var totalPostsSerie = Series[0].As<LineSeries<DateTimePoint>>();
            var totalAuthorsSerie = Series[1].As<LineSeries<DateTimePoint>>();

            var dailyPostsSerieValues = totalPostsSerie.Values.ToList();
            var dailyAuthorsSerieValues = totalAuthorsSerie.Values.ToList();
            var records = new List<CsvData>();

            for (int i = 0; i < dailyPostsSerieValues.Count(); i++)
            {
                records.Add(new CsvData
                {
                    Date = dailyPostsSerieValues[i].DateTime,
                    TotalPosts = dailyPostsSerieValues[i].Value,
                    TotalAuthors = dailyAuthorsSerieValues[i].Value,
                });
            }

            using (var stream = new MemoryStream())
            using (var writer = new StreamWriter(stream))
            using (var csv = new CsvWriter(writer, CultureInfo.InvariantCulture))
            {
                csv.WriteRecords(records);
                writer.Flush();
                return stream.ToArray();
            }
        }

        private class CsvData
        {
            public DateTime Date { get; set; }
            public double? TotalPosts { get; set; }
            public double? TotalAuthors { get; set; }
        }
    }
}
